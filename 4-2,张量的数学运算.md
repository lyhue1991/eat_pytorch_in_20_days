# 4-2,å¼ é‡çš„æ•°å­¦è¿ç®—

å¼ é‡çš„æ“ä½œä¸»è¦åŒ…æ‹¬å¼ é‡çš„ç»“æž„æ“ä½œå’Œå¼ é‡çš„æ•°å­¦è¿ç®—ã€‚

å¼ é‡ç»“æž„æ“ä½œè¯¸å¦‚ï¼šå¼ é‡åˆ›å»ºï¼Œç´¢å¼•åˆ‡ç‰‡ï¼Œç»´åº¦å˜æ¢ï¼Œåˆå¹¶åˆ†å‰²ã€‚

å¼ é‡æ•°å­¦è¿ç®—ä¸»è¦æœ‰ï¼šæ ‡é‡è¿ç®—ï¼Œå‘é‡è¿ç®—ï¼ŒçŸ©é˜µè¿ç®—ã€‚å¦å¤–æˆ‘ä»¬ä¼šä»‹ç»å¼ é‡è¿ç®—çš„å¹¿æ’­æœºåˆ¶ã€‚

æœ¬ç¯‡æˆ‘ä»¬ä»‹ç»å¼ é‡çš„æ•°å­¦è¿ç®—ã€‚

æœ¬ç¯‡æ–‡ç« éƒ¨åˆ†å†…å®¹å‚è€ƒå¦‚ä¸‹åšå®¢ï¼šhttps://blog.csdn.net/duan_zhihua/article/details/82526505

```python

```

### ä¸€ï¼Œæ ‡é‡è¿ç®—


å¼ é‡çš„æ•°å­¦è¿ç®—ç¬¦å¯ä»¥åˆ†ä¸ºæ ‡é‡è¿ç®—ç¬¦ã€å‘é‡è¿ç®—ç¬¦ã€ä»¥åŠçŸ©é˜µè¿ç®—ç¬¦ã€‚

åŠ å‡ä¹˜é™¤ä¹˜æ–¹ï¼Œä»¥åŠä¸‰è§’å‡½æ•°ï¼ŒæŒ‡æ•°ï¼Œå¯¹æ•°ç­‰å¸¸è§å‡½æ•°ï¼Œé€»è¾‘æ¯”è¾ƒè¿ç®—ç¬¦ç­‰éƒ½æ˜¯æ ‡é‡è¿ç®—ç¬¦ã€‚

æ ‡é‡è¿ç®—ç¬¦çš„ç‰¹ç‚¹æ˜¯å¯¹å¼ é‡å®žæ–½é€å…ƒç´ è¿ç®—ã€‚

æœ‰äº›æ ‡é‡è¿ç®—ç¬¦å¯¹å¸¸ç”¨çš„æ•°å­¦è¿ç®—ç¬¦è¿›è¡Œäº†é‡è½½ã€‚å¹¶ä¸”æ”¯æŒç±»ä¼¼numpyçš„å¹¿æ’­ç‰¹æ€§ã€‚

```python
import torch 
import numpy as np 
```

```python
a = torch.tensor([[1.0,2],[-3,4.0]])
b = torch.tensor([[5.0,6],[7.0,8.0]])
a+b  #è¿ç®—ç¬¦é‡è½½
```

```
tensor([[ 6.,  8.],
        [ 4., 12.]])
```

```python
a-b 
```

```
tensor([[ -4.,  -4.],
        [-10.,  -4.]])
```

```python
a*b 
```

```
tensor([[  5.,  12.],
        [-21.,  32.]])
```

```python
a/b
```

```
tensor([[ 0.2000,  0.3333],
        [-0.4286,  0.5000]])
```

```python
a**2
```

```
tensor([[ 1.,  4.],
        [ 9., 16.]])
```

```python
a**(0.5)
```

```
tensor([[1.0000, 1.4142],
        [   nan, 2.0000]])
```

```python
a%3 #æ±‚æ¨¡
```

```
tensor([[1., 2.],
        [0., 1.]])
```

```python
a//3  #åœ°æ¿é™¤æ³•
```

```
tensor([[ 0.,  0.],
        [-1.,  1.]])
```

```python
a>=2 # torch.ge(a,2)  #ge: greater_equalç¼©å†™
```

```
tensor([[False,  True],
        [False,  True]])
```

```python
(a>=2)&(a<=3)
```

```
tensor([[False,  True],
        [False, False]])
```

```python
(a>=2)|(a<=3)
```

```
tensor([[True, True],
        [True, True]])
```

```python
a==5 #torch.eq(a,5)
```

```
tensor([[False, False],
        [False, False]])
```

```python
torch.sqrt(a)
```

```
tensor([[1.0000, 1.4142],
        [   nan, 2.0000]])
```

```python
a = torch.tensor([1.0,8.0])
b = torch.tensor([5.0,6.0])
c = torch.tensor([6.0,7.0])

d = a+b+c
print(d)
```

```
tensor([12., 21.])
```

```python
print(torch.max(a,b))
```

```
tensor([5., 8.])
```

```python
print(torch.min(a,b))
```

```
tensor([1., 6.])
```

```python
x = torch.tensor([2.6,-2.7])

print(torch.round(x)) #ä¿ç•™æ•´æ•°éƒ¨åˆ†ï¼Œå››èˆäº”å…¥
print(torch.floor(x)) #ä¿ç•™æ•´æ•°éƒ¨åˆ†ï¼Œå‘ä¸‹å½’æ•´
print(torch.ceil(x))  #ä¿ç•™æ•´æ•°éƒ¨åˆ†ï¼Œå‘ä¸Šå½’æ•´
print(torch.trunc(x)) #ä¿ç•™æ•´æ•°éƒ¨åˆ†ï¼Œå‘0å½’æ•´
```

```
tensor([ 3., -3.])
tensor([ 2., -3.])
tensor([ 3., -2.])
tensor([ 2., -2.])
```

```python
x = torch.tensor([2.6,-2.7])
print(torch.fmod(x,2)) #ä½œé™¤æ³•å–ä½™æ•° 
print(torch.remainder(x,2)) #ä½œé™¤æ³•å–å‰©ä½™çš„éƒ¨åˆ†ï¼Œç»“æžœæ’æ­£
```

```
tensor([ 0.6000, -0.7000])
tensor([0.6000, 1.3000])
```

```python
# å¹…å€¼è£å‰ª
x = torch.tensor([0.9,-0.8,100.0,-20.0,0.7])
y = torch.clamp(x,min=-1,max = 1)
z = torch.clamp(x,max = 1)
print(y)
print(z)
```

```
tensor([ 0.9000, -0.8000,  1.0000, -1.0000,  0.7000])
tensor([  0.9000,  -0.8000,   1.0000, -20.0000,   0.7000])
```

```python

```

### äºŒï¼Œå‘é‡è¿ç®—


å‘é‡è¿ç®—ç¬¦åªåœ¨ä¸€ä¸ªç‰¹å®šè½´ä¸Šè¿ç®—ï¼Œå°†ä¸€ä¸ªå‘é‡æ˜ å°„åˆ°ä¸€ä¸ªæ ‡é‡æˆ–è€…å¦å¤–ä¸€ä¸ªå‘é‡ã€‚


```python
#ç»Ÿè®¡å€¼

a = torch.arange(1,10).float()
print(torch.sum(a))
print(torch.mean(a))
print(torch.max(a))
print(torch.min(a))
print(torch.prod(a)) #ç´¯ä¹˜
print(torch.std(a))  #æ ‡å‡†å·®
print(torch.var(a))  #æ–¹å·®
print(torch.median(a)) #ä¸­ä½æ•°

```

```
tensor(45.)
tensor(5.)
tensor(9.)
tensor(1.)
tensor(362880.)
tensor(2.7386)
tensor(7.5000)
tensor(5.)

```

```python
#æŒ‡å®šç»´åº¦è®¡ç®—ç»Ÿè®¡å€¼

b = a.view(3,3)
print(b)
print(torch.max(b,dim = 0))
print(torch.max(b,dim = 1))
```

```python

```

```
tensor([[1., 2., 3.],
        [4., 5., 6.],
        [7., 8., 9.]])
torch.return_types.max(
values=tensor([7., 8., 9.]),
indices=tensor([2, 2, 2]))
torch.return_types.max(
values=tensor([3., 6., 9.]),
indices=tensor([2, 2, 2]))
```

```python
#cumæ‰«æ
a = torch.arange(1,10)

print(torch.cumsum(a,0))
print(torch.cumprod(a,0))
print(torch.cummax(a,0).values)
print(torch.cummax(a,0).indices)
print(torch.cummin(a,0))
```

```
tensor([ 1,  3,  6, 10, 15, 21, 28, 36, 45])
tensor([     1,      2,      6,     24,    120,    720,   5040,  40320, 362880])
tensor([1, 2, 3, 4, 5, 6, 7, 8, 9])
tensor([0, 1, 2, 3, 4, 5, 6, 7, 8])
torch.return_types.cummin(
values=tensor([1, 1, 1, 1, 1, 1, 1, 1, 1]),
indices=tensor([0, 0, 0, 0, 0, 0, 0, 0, 0]))
```

```python
#torch.sortå’Œtorch.topkå¯ä»¥å¯¹å¼ é‡æŽ’åº
a = torch.tensor([[9,7,8],[1,3,2],[5,6,4]]).float()
print(torch.topk(a,2,dim = 0),"\n")
print(torch.topk(a,2,dim = 1),"\n")
print(torch.sort(a,dim = 1),"\n")

#åˆ©ç”¨torch.topkå¯ä»¥åœ¨Pytorchä¸­å®žçŽ°KNNç®—æ³•
```

```
torch.return_types.topk(
values=tensor([[9., 7., 8.],
        [5., 6., 4.]]),
indices=tensor([[0, 0, 0],
        [2, 2, 2]]))

torch.return_types.topk(
values=tensor([[9., 8.],
        [3., 2.],
        [6., 5.]]),
indices=tensor([[0, 2],
        [1, 2],
        [1, 0]]))

torch.return_types.sort(
values=tensor([[7., 8., 9.],
        [1., 2., 3.],
        [4., 5., 6.]]),
indices=tensor([[1, 2, 0],
        [0, 2, 1],
        [2, 0, 1]]))

```

```python

```

### ä¸‰ï¼ŒçŸ©é˜µè¿ç®—


çŸ©é˜µå¿…é¡»æ˜¯äºŒç»´çš„ã€‚ç±»ä¼¼torch.tensor([1,2,3])è¿™æ ·çš„ä¸æ˜¯çŸ©é˜µã€‚

çŸ©é˜µè¿ç®—åŒ…æ‹¬ï¼šçŸ©é˜µä¹˜æ³•ï¼ŒçŸ©é˜µè½¬ç½®ï¼ŒçŸ©é˜µé€†ï¼ŒçŸ©é˜µæ±‚è¿¹ï¼ŒçŸ©é˜µèŒƒæ•°ï¼ŒçŸ©é˜µè¡Œåˆ—å¼ï¼ŒçŸ©é˜µæ±‚ç‰¹å¾å€¼ï¼ŒçŸ©é˜µåˆ†è§£ç­‰è¿ç®—ã€‚


```python
#çŸ©é˜µä¹˜æ³•
a = torch.tensor([[1,2],[3,4]])
b = torch.tensor([[2,0],[0,2]])
print(a@b)  #ç­‰ä»·äºŽtorch.matmul(a,b) æˆ– torch.mm(a,b)
```

```
tensor([[2, 4],
        [6, 8]])
```

```python
#çŸ©é˜µè½¬ç½®
a = torch.tensor([[1.0,2],[3,4]])
print(a.t())
```

```
tensor([[1., 3.],
        [2., 4.]])
```

```python
#çŸ©é˜µé€†ï¼Œå¿…é¡»ä¸ºæµ®ç‚¹ç±»åž‹
a = torch.tensor([[1.0,2],[3,4]])
print(torch.inverse(a))
```

```
tensor([[-2.0000,  1.0000],
        [ 1.5000, -0.5000]])
```

```python
#çŸ©é˜µæ±‚trace
a = torch.tensor([[1.0,2],[3,4]])
print(torch.trace(a))
```

```
tensor(5.)
```

```python
#çŸ©é˜µæ±‚èŒƒæ•°
a = torch.tensor([[1.0,2],[3,4]])
print(torch.norm(a))
```

```
tensor(5.4772)
```

```python
#çŸ©é˜µè¡Œåˆ—å¼
a = torch.tensor([[1.0,2],[3,4]])
print(torch.det(a))
```

```
tensor(-2.0000)
```

```python
#çŸ©é˜µç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡
a = torch.tensor([[1.0,2],[-5,4]],dtype = torch.float)
print(torch.eig(a,eigenvectors=True))

#ä¸¤ä¸ªç‰¹å¾å€¼åˆ†åˆ«æ˜¯ -2.5+2.7839j, 2.5-2.7839j 
```

```
torch.return_types.eig(
eigenvalues=tensor([[ 2.5000,  2.7839],
        [ 2.5000, -2.7839]]),
eigenvectors=tensor([[ 0.2535, -0.4706],
        [ 0.8452,  0.0000]]))
```

```python
#çŸ©é˜µQRåˆ†è§£, å°†ä¸€ä¸ªæ–¹é˜µåˆ†è§£ä¸ºä¸€ä¸ªæ­£äº¤çŸ©é˜µqå’Œä¸Šä¸‰è§’çŸ©é˜µr
#QRåˆ†è§£å®žé™…ä¸Šæ˜¯å¯¹çŸ©é˜µaå®žæ–½Schmidtæ­£äº¤åŒ–å¾—åˆ°q

a  = torch.tensor([[1.0,2.0],[3.0,4.0]])
q,r = torch.qr(a)
print(q,"\n")
print(r,"\n")
print(q@r)
```

```python

```

```python
#çŸ©é˜µsvdåˆ†è§£
#svdåˆ†è§£å¯ä»¥å°†ä»»æ„ä¸€ä¸ªçŸ©é˜µåˆ†è§£ä¸ºä¸€ä¸ªæ­£äº¤çŸ©é˜µu,ä¸€ä¸ªå¯¹è§’é˜µså’Œä¸€ä¸ªæ­£äº¤çŸ©é˜µv.t()çš„ä¹˜ç§¯
#svdå¸¸ç”¨äºŽçŸ©é˜µåŽ‹ç¼©å’Œé™ç»´
a=torch.tensor([[1.0,2.0],[3.0,4.0],[5.0,6.0]])

u,s,v = torch.svd(a)

print(u,"\n")
print(s,"\n")
print(v,"\n")

print(u@torch.diag(s)@v.t())

#åˆ©ç”¨svdåˆ†è§£å¯ä»¥åœ¨Pytorchä¸­å®žçŽ°ä¸»æˆåˆ†åˆ†æžé™ç»´

```

```
tensor([[-0.2298,  0.8835],
        [-0.5247,  0.2408],
        [-0.8196, -0.4019]]) 

tensor([9.5255, 0.5143]) 

tensor([[-0.6196, -0.7849],
        [-0.7849,  0.6196]]) 

tensor([[1.0000, 2.0000],
        [3.0000, 4.0000],
        [5.0000, 6.0000]])
```

```python

```

```python

```

### å››ï¼Œå¹¿æ’­æœºåˆ¶


Pytorchçš„å¹¿æ’­è§„åˆ™å’Œnumpyæ˜¯ä¸€æ ·çš„:

* 1ã€å¦‚æžœå¼ é‡çš„ç»´åº¦ä¸åŒï¼Œå°†ç»´åº¦è¾ƒå°çš„å¼ é‡è¿›è¡Œæ‰©å±•ï¼Œç›´åˆ°ä¸¤ä¸ªå¼ é‡çš„ç»´åº¦éƒ½ä¸€æ ·ã€‚
* 2ã€å¦‚æžœä¸¤ä¸ªå¼ é‡åœ¨æŸä¸ªç»´åº¦ä¸Šçš„é•¿åº¦æ˜¯ç›¸åŒçš„ï¼Œæˆ–è€…å…¶ä¸­ä¸€ä¸ªå¼ é‡åœ¨è¯¥ç»´åº¦ä¸Šçš„é•¿åº¦ä¸º1ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¯´è¿™ä¸¤ä¸ªå¼ é‡åœ¨è¯¥ç»´åº¦ä¸Šæ˜¯ç›¸å®¹çš„ã€‚
* 3ã€å¦‚æžœä¸¤ä¸ªå¼ é‡åœ¨æ‰€æœ‰ç»´åº¦ä¸Šéƒ½æ˜¯ç›¸å®¹çš„ï¼Œå®ƒä»¬å°±èƒ½ä½¿ç”¨å¹¿æ’­ã€‚
* 4ã€å¹¿æ’­ä¹‹åŽï¼Œæ¯ä¸ªç»´åº¦çš„é•¿åº¦å°†å–ä¸¤ä¸ªå¼ é‡åœ¨è¯¥ç»´åº¦é•¿åº¦çš„è¾ƒå¤§å€¼ã€‚
* 5ã€åœ¨ä»»ä½•ä¸€ä¸ªç»´åº¦ä¸Šï¼Œå¦‚æžœä¸€ä¸ªå¼ é‡çš„é•¿åº¦ä¸º1ï¼Œå¦ä¸€ä¸ªå¼ é‡é•¿åº¦å¤§äºŽ1ï¼Œé‚£ä¹ˆåœ¨è¯¥ç»´åº¦ä¸Šï¼Œå°±å¥½åƒæ˜¯å¯¹ç¬¬ä¸€ä¸ªå¼ é‡è¿›è¡Œäº†å¤åˆ¶ã€‚

torch.broadcast_tensorså¯ä»¥å°†å¤šä¸ªå¼ é‡æ ¹æ®å¹¿æ’­è§„åˆ™è½¬æ¢æˆç›¸åŒçš„ç»´åº¦ã€‚

```python
a = torch.tensor([1,2,3])
b = torch.tensor([[0,0,0],[1,1,1],[2,2,2]])
print(b + a) 
```

```
tensor([[1, 2, 3],
        [2, 3, 4],
        [3, 4, 5]])
```

```python
a_broad,b_broad = torch.broadcast_tensors(a,b)
print(a_broad,"\n")
print(b_broad,"\n")
print(a_broad + b_broad) 
```

```
tensor([[1, 2, 3],
        [1, 2, 3],
        [1, 2, 3]]) 

tensor([[0, 0, 0],
        [1, 1, 1],
        [2, 2, 2]]) 

tensor([[1, 2, 3],
        [2, 3, 4],
        [3, 4, 5]])
```

```python

```

**å¦‚æžœæœ¬ä¹¦å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œæƒ³é¼“åŠ±ä¸€ä¸‹ä½œè€…ï¼Œè®°å¾—ç»™æœ¬é¡¹ç›®åŠ ä¸€é¢—æ˜Ÿæ˜Ÿstarâ­ï¸ï¼Œå¹¶åˆ†äº«ç»™ä½ çš„æœ‹å‹ä»¬å–”ðŸ˜Š!** 

å¦‚æžœå¯¹æœ¬ä¹¦å†…å®¹ç†è§£ä¸Šæœ‰éœ€è¦è¿›ä¸€æ­¥å’Œä½œè€…äº¤æµçš„åœ°æ–¹ï¼Œæ¬¢è¿Žåœ¨å…¬ä¼—å·"ç®—æ³•ç¾Žé£Ÿå±‹"ä¸‹ç•™è¨€ã€‚ä½œè€…æ—¶é—´å’Œç²¾åŠ›æœ‰é™ï¼Œä¼šé…Œæƒ…äºˆä»¥å›žå¤ã€‚

ä¹Ÿå¯ä»¥åœ¨å…¬ä¼—å·åŽå°å›žå¤å…³é”®å­—ï¼š**åŠ ç¾¤**ï¼ŒåŠ å…¥è¯»è€…äº¤æµç¾¤å’Œå¤§å®¶è®¨è®ºã€‚

![ç®—æ³•ç¾Žé£Ÿå±‹logo.png](./data/ç®—æ³•ç¾Žé£Ÿå±‹äºŒç»´ç .jpg)

```python

```
